<?php
$count = $this->helper('checkout/cart')->getSummaryCount();
$quote = Mage::getModel('checkout/session')->getQuote();
$quoteData= $quote->getData();
?>
<div id="header-wrapper" class=""><!-- container-fluid -->
	<header id="main-header" class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="logo-wrapper hidden-xs hidden-sm visible-md visible-lg">
					<a href="<?php echo $this->getUrl('') ?>" class="site-logo">
						<img src="<?php echo $this->getLogoSrc() ?>" alt="<?php echo $this->getLogoAlt() ?>">
					</a>
				</div>
				<div id="menu-wrapper">
					<?php echo $this->getChildHtml('topMenu') ?>					
				</div>	
				<div id="header-cta">
					<div class="promo-image-text">
						<!-- <div class="promo hidden-xs hidden-sm">							
							<p>Get <span class="red">10%</span> off discount from your first purchase <br>until 17th of Jan with Promo Code: <span class="red">SHOPNOW</span></p>
						</div> -->

						<div class="cta">
							<ul class="cta-list">
								<li>
									<a href="#" class="currency"><span class="hidden-xs hidden-sm"><i class="fa fa-dollar"></i>Currency</span></a>									
								</li>
								<li>
									<a href="#" class="search"><span class="hidden-xs hidden-sm">Search</span></a>									
								</li>
								<?php 
								$session = Mage::getSingleton('customer/session');
								if($session->isLoggedIn()) {
								   $customer = $session->getCustomer();
								   // echo $customer->getName();
								   $customer_name = $customer->getFirstname();
								}
								?>						
								<li><a href="#" class="account"><span class="hidden-xs hidden-sm"><?php echo (isset($customer_name)) ? $customer_name	 : $this->__('Account'); ?></span></a></li>
								<li class="hidden-md hidden-lg"><hr class="divider"></li>
                                <?php if ($count) :?>
                                <li><a href="#" class="cart"><span><?php echo Mage::helper('core')->currency($quoteData['subtotal']); ?> (<?php echo $count; ?>)</span></a></li>
                            	<?php else: ?>
                            	<li><a href="#" class="cart"><span><?php echo $this->__('CART'); ?></span></a></li>
                                <?php endif; ?>
							</ul>
						</div>
						<?php if($session->isLoggedIn()): ?>
							<ul class="account-select">
								<li><a href="<?php echo Mage::getUrl('customer/account'); ?>">My Account</a></li>
								<li><a href="<?php echo Mage::helper('customer')->getLogoutUrl(); ?>">Log Out</a></li>
							</ul>
						<?php else: ?>
							<ul class="account-select">
								<li><a href="<?php echo Mage::helper('customer')->getLoginUrl(); ?>">Log In</a></li>
							</ul>
						<?php endif; ?>
						<div class="cart-preview-select">
							<h5><img src="<?php echo $this->getSkinUrl('images/icons/cart.png'); ?>" alt=""> SHOPPING CART</h5>
							<?php 
								$cart = Mage::getModel('checkout/cart')->getQuote();
								$cartQty = $this->helper('checkout/cart')->getSummaryCount();
								$cartTotal = $this->helper('checkout/cart')->getQuote()->getGrandTotal();
							?>
							<?php if ($cartQty>0): ?>							        
								    
								<ul class="cart-header">
									<li>PRODUCT</li>
									<li>QTY</li>
									<li>SUB TOTAL</li>
								</ul>
								
								<?php								
								foreach ($cart->getAllItems() as $item) {
								    $productName = $item->getProduct()->getName();
								    $productPrice = $item->getProduct()->getPrice();
								    $productQty = $item->getQty();
								    $priceInclVat = $item->getRowTotalInclTax();
								    $productImage = Mage::helper('catalog/image')->init($item->getProduct(), 'thumbnail');
								    
								?>
								<ul class="cart-content">							
									<li><img src="<?php echo $productImage; ?>" alt=""><span><?php echo $productName; ?></span></li>
									<li><?php echo $productQty; ?></li>
									<li><?php echo Mage::helper('core')->currency($priceInclVat, true, false); ?></li>
								</ul>
								<?php
								}
								?>
								<ul class="cart-summary">								
							        <?php if ($cartQty==1): ?>
							            <?php echo '<li><span class="total-items">1 ITEM</span></li>'; ?>
							        <?php else: ?>
							            <?php echo '<li><span class="total-items">'.$cartQty.' ITEMS</span></li>'; ?>
							        <?php endif; ?>
							        <li><span class="sub-total">SUB TOTAL</span></li>									
							        <li><span class="sub-total-amount"><?php echo Mage::helper('core')->currency($cartTotal, true, false); ?></span></li>							
								</ul>

								<div class="cta-btns">
									<a href="<?php echo $this->getUrl('store');?>" class="continue-shopping"><button type="button" class="cta button"><span><span>Back to Shopping</span></span></button></a>
            						<a href="<?php echo $this->getUrl('checkout/cart'); ?>" class="shopping-cart"><button type="button" class="cta button"><span><span>Shopping Cart</span></span></button></a>
								</div>
							<?php else: ?>
								<p>Your cart is empty. <a href="<?php echo $this->getUrl('checkout/cart'); ?>">Click here to go to cart anyway.</a></p>
							<?php endif; ?>
							
						</div>
						<?php echo $this->getChildHtml('topSearch') ?>
			            <?php echo $this->getChildHtml('currency_top') ?>			            
					</div>
				</div>
			</div>
		</div>
	</header>
</div>
